---
title: Cumulative
author: David Kane and Mihir Kaushal
tutorial:
  id: cumulative
output:
  learnr::tutorial:
    progressive: yes
    'allow_skip:': yes
runtime: shiny_prerendered
description: 'Tutorial: Cumulative'
---

```{r setup, include = FALSE}
# First packages are ones which students don't know about or load up. learnr and
# tutorial.helpers are required for the tutorial to work at all. gt is often
# needed because we often show a Preceptor Table to the students, which is built
# with this package, even though we don't show students how to create it.

library(learnr)
library(tutorial.helpers)
library(gt)

# Any package from here is something that we want students to explicitly load up
# in the tutorial. This serves two purposes. First, it provides an occasion for
# knowledge drops. Second, it reminds students that these packages must be
# loaded in the Console if they want any of the code from the tutorial to work
# in the Console. (Of course, different lines of code require different
# packages.) The most common package to be added to this section, and which
# should also be loaded by students, is a data source like primer.data.

library(tidyverse)
library(primer.data)
library(brms)
library(tidybayes)
library(gtsummary)

knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 600, 
        tutorial.storage = "local") 

x <- ces |>
  filter(year == 2020) |>
  select(faminc, ideology, approval_ch, education) |>
  drop_na() |> 
  slice_sample(n = 2000)

# Adjust/remove the cores argument depending on your machine, without a lot of
# cores, this can take a while.

# fit_approve <- brm(formula = approval_ch ~ ideology + faminc + education,
#                    data = x,
#                    family = cumulative(),
#                    refresh = 0,
#                    silent = 2,
#                    seed = 19)
# write_rds(fit_approve, "data/fit_approve.rds")
 
fit_approve <- read_rds("data/fit_approve.rds")

```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

<!-- DK: Add here a discussion about the data sampling and model fitting issues we explored. -->

<!-- Sometimes brm() takes very long because the data is very large. In order to combat this problem, we can randomly choose a set amount from the data using slice_sample(). When we used slice_sample(n = 2000) and compared the outcome of the brm to the brm with the whole data, the results of the estimation were very similar. The key difference was the confidence interval; the confidence interval for the model with the larger data was smaller than the confidence interval for the smaller data. For our purposes, the data with only 2,000 observations was accurate enough for us to use. This might be different for different types of models. -->

## Introduction
### 

This tutorial is best understood when done after reading [*Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference*](https://ppbds.github.io/primer/) by [David Kane](https://davidkane.info/). 

## The Question
### 

*The power to question is the basis of all human progress.* - Indira Gandhi

### Exercise 1

Load **tidyverse**.

```{r the-question-1, exercise = TRUE}

```

```{r the-question-1-hint-1, eval = FALSE}
library(tidyverse)
```

```{r the-question-1-test, include = FALSE}
library(tidyverse)
```

### 

The data we will be looking at for this tutorial comes form a study where people rate how much they approve the current president.

The [Cooperative Election Study](https://cces.gov.harvard.edu/) (CES) is one of the largest political surveys in the United States.

### Exercise 2

Load the **primer.data** package.

```{r the-question-2, exercise = TRUE}

```

```{r the-question-2-hint-1, eval = FALSE}
library(primer.data)
```

```{r the-question-2-test, include = FALSE}
library(primer.data)
```

### 

A version of the data from the Cooperative Congressional Election Study is available in the `ces` tibble.

### Exercise 3

After loading **primer.data** in your Console, type `?ces` in the Console, and paste in the Description below.

```{r the-question-3}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

The data has `r scales::comma(nrow(ces))` observations and `r scales::comma(ncol(ces))` variables.

### Exercise 4

Approval of the president is the broad topic of this tutorial. Given that topic, which variable in `ces` should we use as our outcome variable? 

```{r the-question-4}
question_text(NULL,
	message = "The `approval_ch` variable shows the approval of the president.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 2)
```

### 

`approval_ch` is an ordered factor variable and takes values of "Strongly Approve", "Approve / Somewhat Approve", "Neither Approve Nor Disapprove", "Disapprove / Somewhat Disapprove", and "Never Heard / Not Sure".

### Exercise 5

Pick a variable in the data which might have a connection to the outcome variable and which we might consider to be, at least in theory, a treatment. (If you don't see a reasonable variable in the data, you can just name an imaginary variable which *might have been* included in the data.) How might we manipulate this variable?

```{r the-question-5}
question_text(NULL,
	message = "Consider positive Facebook ads as a treatment. We might expose some people to those ads and not others. Then, we could measure the causal effect of ads on presidential approval.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Such a variable does not exist in our data. There are several variables we can think of that could impact the `approval_ch`, but there is no treatment variable in our data. 

We could look at the predictive relationship between `approval_ch` and one of the many covariates in our data. 

### Exercise 6

Let's consider a *predictive* model. Which variable in `ces` do you think might have an important connection to `approval_ch`? 

```{r the-question-6}
question_text(NULL,
	message = "The ideology of an individual could be connected to their approval of the president. If the president is a Republican, we might expect more conservative individuals to have stronger measured approval.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 2)
```

### 

There is no right answer! The `ces` tibble has 17 variables. For the rest of this tutorial, we will be focusing on `ideology` as the main explanatory variable, but our model will certainly include other variables. 

### Exercise 7

Write a few sentences which specify two different groups of people with different values for `ideology`. Explain that the outcome variable might differ between these two groups.

```{r the-question-7}
question_text(NULL,
	message = "Some people might have a value for ideology of Very Liberal. Others might have a value of Very Conservative. Those two groups might, on average, have different values for pesidential approval, our outcome variable.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The survey consists of two waves in election years. In the pre-election wave, respondents answer two-thirds of the questionnaire from late September to late October. In the post-election wave, respondents answer the other third of the questionnaire in November.

### Exercise 8

Write a predictive question which connects the outcome variable `approval_ch` to covariates of interest. 

```{r the-question-8}
question_text(NULL,
	message = "What is the relationship between the approval of the president and an individual's ideology?",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The phrasing of the survey when asking for the individual's approval of the president matters because if someone was first asked questions about the economy, and the economy was doing good, then that person might be more likely to approve of the president. The people conducting the survey have to be careful of the way they phrase their questions because people could respond differently depending on the phrasing.

Fortunately, the study is being operated by several professionals that know what they are doing, so they will have an appropriate phrasing of the questions. 

### Exercise 9

What is the Quantity of Interest which might help us to explore the answer to our question?

```{r the-question-9}
question_text(NULL,
	message = "One quantity of interest might be the difference in Strong Approval for the President between Very Conservative and Very Liberal people.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The quantity of interest for this question is more complex because we have five numbers. Our outcome variable, `approval_ch`, has five values. Each of those values becomes a quantity of interest. 

## Wisdom
### 

*The doorstep to the temple of wisdom is a knowledge of our own ignorance.* - Benjamin Franklin

Our question:

> *What is the relationship between the approval of the president and an individual's ideology?*

### Exercise 1

In your own words, describe the key components of Wisdom when working on a data science problem.

```{r wisdom-1}
question_text(NULL,
	message = "Wisdom requires the creation of a Preceptor Table, an examination of our data, and a determination, using the concept of validity, as to whether or not we can (reasonably!) assume that the two come from the same population.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The ces is an online survey. The total amount of time for both waves of the survey take around 30 minutes. Respondents are compensated by points for taking each survey which can be exchanged for giftcards and other prizes.

### Exercise 2

Define a Preceptor Table.

```{r wisdom-2}
question_text(NULL,
	message = "A Preceptor Table is the smallest possible table of data with rows and columns such that, if there is no missing data, we can easily calculate the quantities of interest.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The CES is designed to be representative of all national adults, even those who do not vote.

### Exercise 3

Describe the key components of Preceptor Tables in general, without worrying about this specific problem. Use words like "units," "outcomes," and "covariates."

```{r wisdom-3}
question_text(NULL,
	message = "The rows of the Preceptor Table are the units. The outcome is at least one of the columns. If the problem is causal, there will be at least two (potential) outcome columns. The other columns are covariates. If the problem is causal, at least one of the covariates will be a treatment.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

This problem is not causal so there is no treatment. In order to make causal relationships, the data needs to be manipulated. In `ces`, the data is observed, there was no manipulated variables.

### Exercise 4

Create a Github repo called `cumulative`. Make sure to click the "Add a README file" check box.

Connect the `cumulative` Github repo to an R project on your computer. Name the R project `cumulative` also.

Select `File -> New File -> Quarto Document ...`. Provide a title (`"Cumulative"`) and an author (you). Render the document and save it as `analysis.qmd`.

Edit the `.gitignore` by adding `*Rproj`. Save and commit this in the Git tab. Push the commit.

In the Console, run:

```         
show_file(".gitignore")
```

CP/CR.

```{r wisdom-4}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Remove everything below the YAML header from `analysis.qmd` and render the file. `Command/Ctrl + Shift + K` renders the file, this automatically saves the file as well.

### Exercise 5

What are the units for this problem?

```{r wisdom-5}
question_text(NULL,
	message = "Adults in the United States of America.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

If our question was different, we could have different units. For example, if our question was focused only on people who were Conservative, then our units would only be adults in the United States of America who were also Conservative.

### Exercise 6

What is/are the outcome/outcomes for this problem?

```{r wisdom-6}
question_text(NULL,
	message = "approval_ch has the approval rating of the president.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Again, `approval_ch` has five values: "Strongly Approve", "Approve / Somewhat Approve", "Neither Approve Nor Disapprove", "Disapprove / Somewhat Disapprove", and "Never Heard / Not Sure". These five values give us five numbers. If there were only two values, approve or not approve, then there would only be two numbers we would care about.

### Exercise 7

What are some covariates which you think might be useful for this problem, regardless of whether or not they might be included in the data?

```{r wisdom-7}
question_text(NULL,
	message = "Sex and race could have a relationship with the approval of the president.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

There are variables outside the data we have that could have a meaningful relationship with `approval_ch`. Whether or not the individual comes from an immigrant family could have a relationship with their approval of the president.

### Exercise 8

What are the treatments, if any, for this problem?

```{r wisdom-8}
question_text(NULL,
	message = "There are no treatments.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Because this is a predictive model, none of the covariates are considered to be treatments. Recall that a "treatment" is just a covariate which we can, at least in theory, manipulate and which, since we have decided we want a causal model, we are assuming creates two (or more) potential outcomes.

### Exercise 9

What moment in time does the Preceptor Table refer to?

```{r wisdom-9}
question_text(NULL,
	message = "2020",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Each president will have different approval rates. We will be focusing on only the year 2020.

### Exercise 10

Define causal effect.

```{r wisdom-10}
question_text(NULL,
	message = "A causal effect is the difference between two potential outcomes.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

This is a predictive model, not because of anything intrinsic in the data. We make a predictive model because we are asking a predictive question. We want to *compare* approval between groups of people who differ in their ideology. We don't want to estimate the causal effect on approval of changes, within a single individual, in ideology.

### Exercise 11

What is the fundamental problem of causal inference?

```{r wisdom-11}
question_text(NULL,
	message = "The fundamental problem of causal inference is that we can only observe one potential outcome.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Since our question is not causal, this dilemma does not have a major impact on us. 

### Exercise 12

How does the motto "No causal inference without manipulation." apply in this problem?

```{r wisdom-12}
question_text(NULL,
	message = "Since the data is only a survey, without any manipulation, we cannot make any causal inferences.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The motto does not apply because this is a predictive, not causal, model.

### Exercise 13

Describe in words the Preceptor Table for this problem.

```{r wisdom-13}
question_text(NULL,
	message = "The Preceptor Table has 3 columns. There is a column for the ID, and one for the outcome. There will be a column for ideology Each row represents one individual.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The Preceptor Table for this problem looks something like this:

```{r}
#| echo: false
tibble(ID = c("1", "2", "...", "10", "11", "...", "N"),
       approval_ch = c("Neither Approve Nor Disapprove", "Disapprove / Somewhat Disapprove", "...", "Strongly Approve", "Never Heard / Not Sure", "...", "Neither Approve Nor Disapprove"),
       ideology = c("Moderate", "Very Liberal", "...", "Moderate", "Not Sure", "...", "Conservative")) |>
  
  gt() |>
  tab_header(title = "Preceptor Table") |> 
  cols_label(ID = md("ID"),
             approval_ch = md("Approval of the President"),
             ideology = md("Political Ideology")) |>
  tab_style(cell_borders(sides = "right"),
            location = cells_body(columns = c(ID))) |>
  tab_style(style = cell_text(align = "left", v_align = "middle", size = "large"), 
            locations = cells_column_labels(columns = c(ID))) |>
  cols_align(align = "center", columns = everything()) |>
  cols_align(align = "left", columns = c(ID)) |>
  fmt_markdown(columns = everything()) |>
  tab_spanner(label = "Covariates", columns = c(ideology)) |>
  tab_spanner(label = "Outcomes", columns = c(approval_ch))
```

### Exercise 14

In `analysis.qmd`, delete everything past the YAML heading and load the **tidyverse** and the **primer.data** packages in a new code chunk. Label it the set up by adding `#| label: setup`. Render the file.

Notice that the file does not look good because it is has code that is showing and it also has messages. To take care of this, add `#| message: false` to remove all the messages in the setup chunk. Also add the following to the YAML header to remove all echo from the whole file:

```         
execute: 
  echo: false
```

In the Console, run:

```         
show_file("analysis.qmd", start = -5)
```

CP/CR.

```{r wisdom-14}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Render again. Everything looks nice because we have added code to make the file look better and more professional.

### Exercise 15

Write one sentence describing the data you have to answer your question.

```{r wisdom-15}
question_text(NULL,
	message = "The Cooperative Congressional Election Study is one of the largest political surveys in the United States and was started in 2006. The data has how much people approve of the president as well as other useful variables such as ideology.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Of course, when doing the analysis, you don’t know when you start what you will be using at the end. Data analysis is a circular process. We mess with the data. We do some modeling. We mess with the data on the basis of what we learned from the models. With this new data, we do some more modeling. And so on.

### Exercise 16

Run `glimpse()` on `ces`.

```{r wisdom-16, exercise = TRUE}

```

```{r wisdom-16-hint-1, eval = FALSE}
glimpse(...)
```

```{r wisdom-16-test, include = FALSE}
glimpse(ces)
```

### 

`glimpse()` gives us a look at the raw data contained within the `ces` data set. At the very top of the output, we can see the number of rows and columns, or observations and variables, respectively. We see that there are 617,455 observations, with each row corresponding to a unique respondent.

### Exercise 17

Pipe `ces` to `filter()` with `year` set to `2020` inside of it using `==`.

```{r wisdom-17, exercise = TRUE}

```

```{r wisdom-17-hint-1, eval = FALSE}
ces |> filter(...)
```

```{r wisdom-17-test, include = FALSE}
ces |> filter(year == 2020)
```

### 

We will be focusing on the year 2020 so that we have fewer number of rows to work with. 

### Exercise 18

Continue the pipe to `select()` and have `approval_ch`, `education`, `faminc`, and `ideology` inside.

```{r wisdom-18, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>
```{r wisdom-18-hint-1, eval = FALSE}
... |> select(...)
```

```{r wisdom-18-test, include = FALSE}
ces |> filter(year == 2020) |> select(approval_ch, education, faminc, ideology)
```

### 

We are selecting only the rows we will use in the future. Of course, we could choose any of the other variables, but we will be focusing on only these four for this tutorial. 

### Exercise 19

Finish the pipe with `drop_na()`. Add `slice_sample(n = 2000)` at the very end to only select 2,000 observations from the data. 

```{r wisdom-19, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>
```{r wisdom-19-hint-1, eval = FALSE}
... |> drop_na() |>
  slice_sample(...)
```

```{r wisdom-19-test, include = FALSE}
ces |> filter(year == 2020) |> select(approval_ch, education, faminc, ideology) |>
  drop_na() |>
  slice_sample(n = 2000)
```

### 

Behind the scenes of this tutorial, we have created an object called `x` using the previous code. 

### Exercise 20

To see the object that was created in the background, run `x`.

```{r wisdom-20, exercise = TRUE}

```

```{r wisdom-20-hint-1, eval = FALSE}
# x
```

### 

There are now only 54,839 rows which is significantly fewer than the whole `ces` data. Having more manageable data will make it easier for us to create models.

### Exercise 21

In `analysis.qmd`, add a new code chunk. Copy the code from two exercises ago which prepares the data and paste it in the code chunk. Set the code to an object called `x`. 

Render the file. In the Console, run:

```         
show_file("analysis.qmd", start = -5)
```

CP/CR.

```{r wisdom-21}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

The CES is a 50,000+ person national stratified sample survey administered by YouGov. Half of the questionnaire consists of Common Content asked of all 50,000+ people, and half of the questionnaire consists of Team Content designed by each individual participating team and asked of a subset of 1,000 people.

### Exercise 22

Pipe `x` to `summary()`.

```{r wisdom-22, exercise = TRUE}

```

```{r wisdom-22-hint-1, eval = FALSE}
summary(...)
```

```{r wisdom-22-test, include = FALSE}
# summary(x)
```

### 

We can see some information about our data. Most people have a family income between 20k and 30k. Most people are moderate in terms of political ideology. Most people strongly disapprove the president, the second biggest group for that variable is strongly approve. Most people only have a high school as their highest education. 

### Exercise 23

Pipe `x` to `ggplot()` with `x` set to `ideology` and `fill` set to `approval_ch`. Then add a layer of `geom_bar`.

```{r wisdom-23, exercise = TRUE}

```

```{r wisdom-23-hint-1, eval = FALSE}
x |>
  ggplot(aes(...)) +
  geom_bar()
```

```{r wisdom-23-test, include = FALSE}
x |>
  ggplot(aes(x = ideology, fill = approval_ch)) +
  geom_bar()
```

### 

This graphs shows that most liberals strongly disapprove the 2020 president and most conservatives strongly support the 2020 president. 

### Exercise 24

Using the previous code, add `labs()`.

```{r wisdom-24, exercise = TRUE}

```

<button onclick="transfer_code(this)">Copy previous code</button>
```{r wisdom-24-hint-1, eval = FALSE}
... +
  labs(...)
```

```{r wisdom-24-test, include = FALSE}
x |>
  ggplot(aes(x = ideology, fill = approval_ch)) +
  geom_bar() +
  labs(title = "Relationship Between President Approval and Political Ideology in 2020",
       subtitle = "Most people strongly disapprove.",
       x = "Political Ideology",
       y = "Count",
       fill = "Approval of the President",
       caption = "Data from CES.")
```

### 

The graph should look like this:

```{r}
#| echo: false

x |>
  ggplot(aes(x = ideology, fill = approval_ch)) +
  geom_bar() +
  labs(title = "Relationship Between President Approval and Political Ideology",
       subtitle = "Most people strongly disapprove.",
       x = "Political Ideology",
       y = "Count",
       fill = "Approval of the President",
       caption = "Data from CES.")
```

### Exercise 25

In `analysis.qmd`, add the code the previous exercise to add the graph in the file.

Render the file. In the Console, run:

 ```         
show_file("analysis.qmd", start = -5)
```

CP/CR.

```{r wisdom-25}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

This graph is useful but we still need to create an actual model with this data in order to answer our questions.

### Exercise 26

In your own words, define "validity" as we use the term.

```{r wisdom-26}
question_text(NULL,
	message = "Validity is the consistency, or lack thereof, in the columns of the data set and the corresponding columns in the Preceptor Table.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

In order to consider the two data sets to be drawn from the same population, the columns from one must have a valid correspondence with the columns in the other.

### Exercise 27

Provide one reason why the assumption of validity might not hold for the outcome variable: `approval_ch`.

```{r wisdom-27}
question_text(NULL,
	message = "Both the colums in the data we have and the Preceptor Table have a variable called approval_ch, but the Preceptor Table is the true approval of the president where as the data only has the self reported approval of the president. People could lie about their approval of the president.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

These two columns have the same name but they might not be similar enough because the self reported approval of the president might be different from their true approval of the president. 

### Exercise 28

Provide one reason why the assumption of validity might not hold for the covariate: `ideology`.

```{r wisdom-28}
question_text(NULL,
	message = "There is a column in the Preceptor Table for ideology, and a column in our data for idology. People might misidentify themselves if they do not know the difference between the ideologies or they have a different definition for the ideologies. This might create a difference between their true identity and their self claimed identity.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Again, validity is all about columns. We have to make sure that the columns in our data fully match the columns in the Preceptor Table. Both of the columns talk about ideologies, but key difference is the true political identity vs their self claimed political identity.

### Exercise 29

Summarize the state of your work so far in one sentence. Make reference to the data you have and to the specific question you are trying to answer. 

```{r wisdom-29}
question_text(NULL,
	message = "Using the CES, which is one of the largest political surveys in the United States, we seek to make a predictive model which could help us see a relationship between approval of the president and an individual's political ideology.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Edit you answer as you see fit, but do not copy/paste our answer exactly. Add this summary to `analysis.qmd`, `Command/Ctrl + Shift + K`, and then commit/push.

## Justice
### 

*The arc of the moral universe is long, but it bends toward justice.* - Theodore Parker

### Exercise 1

In your own words, name the four key components of Justice for working on a data science problem.

```{r justice-1}
question_text(NULL,
	message = "Justice concerns four topics: the Population Table, stability, representativeness, and unconfoundedness.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

No data is perfect, we have to look for reasons why the model we will create might not work as well as we hope. An important skill to have as a data scientist is to know the limitations of the model. 

### Exercise 2

In your own words, define a Population Table.

```{r justice-2}
question_text(NULL,
	message = "The Population Table includes a row for each unit/time combination in the underlying population from which both the Preceptor Table and the data are drawn.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

The Population Table is almost always much bigger than the combination of the Preceptor Table and the data because, if we can really assume that both the Preceptor Table and the data are part of the same population, than that population must cover a broad universe of time and units since the Preceptor Table and the data are, themselves, often far apart from each other.

### Exercise 3

In your own words, define the assumption of "stability" when employed in the context of data science.

```{r justice-3}
question_text(NULL,
	message = "Stability means that the relationship between the columns in the Population Table is the same for three categories of rows: the data, the Preceptor Table, and the larger population from which both are drawn.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Stability is all about *time*. Is the relationship among the columns in the Population Table stable over time? In particular, is the relationship --- which is another way of saying "mathematical formula" --- at the time the data was gathered the same as the relationship at the (generally later) time references by the Preceptor Table.

### Exercise 4

Provide one reason why the assumption of stability might not be true in this case.

```{r justice-4}
question_text(NULL,
	message = "We are concerned about the year 2020 and the data we have has information for 2020, so their is no danger to stability. The time the data was gathered is the same as the time refered to in the Preceptor Table.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

If we wanted to make a predictive model for this year, then we might have a major stability problem because the relationship between presidential approval and ideology depends a great deal on the ideology of the president whose approval we are measuring.

### Exercise 5

We use our data to make inferences about the overall population. We use information about the population to make inferences about the Preceptor Table: `Data -> Population -> Preceptor Table`. In your own words, define the assumption of "representativeness" when employed in the context of data science.

```{r justice-5}
question_text(NULL,
	message = "Representativeness, or the lack thereof, concerns two relationships among the rows in the Population Table. The first is between the data and the other rows. The second is between the other rows and the Preceptor Table.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Ideally, we would like both the Preceptor Table *and* our data to be random samples from the population. Sadly, this is almost never the case. 

### Exercise 6

We do not use the data, directly, to estimate missing values in the Preceptor Table. Instead, we use the data to learn about the overall population. Provide one reason, involving the relationship between the data and the population, for why the assumption of representativeness might not be true in this case.

```{r justice-6}
question_text(NULL,
	message = "The CES website claims that they designed the study to be representative of all adults. But, they could make mistakes while executing the study would make the sample not representative of the larger population. For example, the way they select people for the survey might be flawed.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

A large portion of the CES respondents are YouGov panelists. This group might not representative of the whole population because they might be more politically active and care more about politics than other people do.

### Exercise 7

We use information about the population to make inferences about the Preceptor Table. Provide one reason, involving the relationship between the population and the Preceptor Table, for why the assumption of representativeness might not be true in this case.

```{r justice-7}
question_text(NULL,
	message = "Because the Preceptor Table includes the entire population, there is no problem with representativeness in using the population to draw inferences about the Precetor Table. They are one and the same.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

<!-- XX: What we discussed. Big picture: If you are the Preceptor Table includes all the units that exist now then, in the vast majority of cases, those are the same units as existed in the past when we sampled. In other words, the units now are 99.9% the same as the units then. So, almost by definition, they are representative. -->

Since the units in the Preceptor Table and the units in the population are both adults in the United States of America, they are representative.

### Exercise 8

In your own words, define the assumption of "unconfoundedness" when employed in the context of data science.

```{r justice-8}
question_text(NULL,
	message = "Unconfoundedness means that the treatment assignment is independent of the potential outcomes, when we condition on pre-treatment covariates.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

This assumption is only relevant for causal models. We describe a model as "confounded" if this is not true. 

### Exercise 9

Summarize the state of your work so far in two or three sentences. Make reference to the data you have and to the question you are trying to answer. Feel free to copy from your answer at the end of the Wisdom Section. Mention one specific problem which casts doubt on your approach. 

```{r justice-9}
question_text(NULL,
	message = "Using the CES, which is one of the largest political surveys in the United States, we seek to understand the relationship between presidential approval and political ideology in 2020. One concern is that survey respondents might be systematically different from other Americans.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Edit the summary paragraph in `analysis.qmd` as you see fit, but do not copy/paste our answer exactly. `Command/Ctrl + Shift + K`, and then commit/push.

## Courage
### 

*Courage is going from failure to failure without losing enthusiasm.* - Winston Churchill

### Exercise 1

In your own words, describe the components of the virtue of Courage for analyzing data.

```{r courage-1}
question_text(NULL,
	message = "Courage begins with the exploration and testing of different models. It concludes with the creation of a Data Generating Mechanism.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

We first specify the mathematical formula which connects the outcome variable we are interested in with the other data that we have. We need to decide which variables to include and to estimate the values of unknown parameters. We check our models for consistency with the data we have. We avoid hypothesis tests.

### Exercise 2

Load the **brms** package.

```{r courage-2, exercise = TRUE}

```

```{r courage-2-hint-1, eval = FALSE}
library(...)
```

```{r courage-2-test, include = FALSE}
library(brms)
```

### 

Given that the outcome is an ordered factor variable, we will be making an ordinal regression model. 

### Exercise 3

Load the **tidybayes** package.

```{r courage-3, exercise = TRUE}

```

```{r courage-3-hint-1, eval = FALSE}
library(...)
```

```{r courage-3-test, include = FALSE}
library(tidybayes)
```

### 

We will create a model that estimates `approval_ch` as a function of `faminc`, `ideology`, and `education`.

### Exercise 4

Add `library(brms)` and `library(tidybayes)` to `analysis.qmd`. `Command/Ctrl + Shift + K`. At the Console, run:

```
tutorial.helpers::show_file("analysis.qmd", pattern = "brms|tidybayes")
```

CP/CR.

```{r courage-4}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

The `|` regular expression in the `show_file()` call allows us to just pull out the two lines in the QMD which we want. 

### Exercise 5

Create a model using `brm()` from the **brms** package. Your arguments should be `formula = approval_ch ~ ideology + faminc + education`, `data = brm_data`, `family = cumulative()`, `refresh = 0`, `silent = 2`, and `seed = 19`. 

```{r courage-5, exercise = TRUE}

```

```{r courage-5-hint-1, eval = FALSE}
brm(...)
```

### 

The cumulative family leads to ordinal regression.

### Exercise 6

Behind the scenes, we have used `brm()` to create an object named `fit_approve`. This version was created using `x` so it has more rows than the one you created in the previous exercise.

Type `fit_approve` and hit "Run Code." This generates the same results as using `print(fit_approve)`.

```{r courage-6, exercise = TRUE}

```

```{r courage-6-hint-1, eval = FALSE}
fit_approve
```

```{r courage-6-test, include = FALSE}
fit_approve
```

### 

Using 2,000 observations from the data instead of the whole data should not make a huge difference in the model because we chose a random sample and because 2,000 rows should be enough to make an acurate model for our purposes. 

### Exercise 7

Run `family()` on `fit_approve`. `family()` provides information about the "family" of the error term and the link between it and the dependent variable. 

```{r courage-7, exercise = TRUE}

```

```{r courage-7-hint-1, eval = FALSE}
family(...)
```

```{r courage-7-test, include = FALSE}
family(fit_approve)
```

### 

In this case, the family is cumulative which can be used to create ordinal regression.

### Exercise 8

Run `formula()` on `fit_approve`. `formula()` returns the statistical equation which relates the dependent variable to the independent variable(s). 

```{r courage-8, exercise = TRUE}

```

```{r courage-8-hint-1, eval = FALSE}
formula(...)
```

```{r courage-8-test, include = FALSE}
formula(fit_approve)
```

### 

In this case, the formula is `approval_ch ~ ideology + faminc + education`.

### Exercise 9

Run `nobs()` on `fit_approve`. The `nobs()` function returns the **n**umber of **obs**ervations.

```{r courage-9, exercise = TRUE}

```

```{r courage-9-hint-1, eval = FALSE}
nobs(...)
```

```{r courage-9-test, include = FALSE}
nobs(fit_approve)
```

### 

In this case, there should be 54,839 observations.

Again, `fit_approve` will have more rows than the one you have created because you used only 2,000 observations from the data to save time while creating the fit object using `brm()`.

### Exercise 10

Add mathematical formula for your model, using $\LaTeX$ math notation to `analysis.qmd`.

<!-- MK: What is the proper math notation for this model? -->

<!-- Check out 4 parameters categorical. Do it like there! -->

<!-- cumulative(link = "logit", link_disc = "log", threshold = "flexible") -->

$$ approval\_ch_i  \sim Cumulative(\rho_{strong\_approval},  \rho_{\_approval}, \rho_{strong\_approval} ... XX) $$        
Approvals add to 1.

$$\rho_{strong\_approval} \sim logit(ideology_i,  faminc_i, education_i)$$
Reminder:

$$
\rho = \frac{e^{\beta_0 + \beta_1 x_1 + \ldots }}{1 + e^{\beta_0 + \beta_1 x_1 + \ldots }}
$$

<!-- There are generally two parts for a statistical model: family and link function. The family is the probability distribution which generates the randomness in our data. The link function is the mathematical formula which links our data to the unknown parameters in the probability distribution. -->

### 

Add the formula to `analysis.qmd`. `Command/Ctrl + Shift + K`. Ensure that the formula is looks correct.

### Exercise 11

Create a new code chunk in `analysis.qmd`. Add two code chunk options: `label: model` and `cache: true`. Copy/paste the code from above for estimating the model using `brm()` into the code chunk, assigning the result to `fit_approve`. 

`Command/Ctrl + Shift + K`. It may take some time to render `analysis.qmd`. 

At the Console, run:

```
tutorial.helpers::show_file("analysis.qmd", start = -8)
```

CP/CR.

```{r courage-11}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

By including `cache: true` you cause Quarto to cache the results of the chunk. The next time you render `analysis.qmd`, as long as you have not changed the code, Quarto will just load up the saved fitted object.

To confirm, `Command/Ctrl + Shift + K` again. It should be quick.

### Exercise 12

Run `posterior_interval()` on `fit_approve`. The `posterior_interval()` function returns 95% intervals for all the parameters in our model.

```{r courage-12, exercise = TRUE}

```

```{r courage-12-hint-1, eval = FALSE}
posterior_interval(...)
```

```{r courage-12-test, include = FALSE}
posterior_interval(fit_approve)
```

### 

In this case, `faminc` has 0 included inside the 95% confidence interval, this means that we are not sure if family income has a relationship with presidential approval. 

### Exercise 13

Run `fixef()` on `fit_approve`. The `fixef()` returns information about the **fix**ed **ef**fects in the model.

```{r courage-13, exercise = TRUE}

```

```{r courage-13-hint-1, eval = FALSE}
fixef(...)
```

```{r courage-13-test, include = FALSE}
fixef(fit_approve)
```

### 

In this case, we can again see that family income has no correlation with presidential approval. From now on, we can drop `faminc` from the model because it has no relationship with `approval_ch`. 

### Exercise 14

Run `pp_check()` on `fit_approve`. The `pp_check()` runs a **p**osterior **p**redictive check.

```{r courage-14, exercise = TRUE}

```

```{r courage-14-hint-1, eval = FALSE}
pp_check(...)
```

```{r courage-14-test, include = FALSE}
pp_check(fit_approve)
```

This might take some time.

### 

In this case, there is a peak at when the x-axis is at 1. 

### Exercise 15

Use `library()` to load the [**gtsummary**](https://www.danieldsjoberg.com/gtsummary) package.

```{r courage-15, exercise = TRUE}

```

```{r courage-15-hint-1, eval = FALSE}
library(gtsummary)
```

```{r courage-15-test, include = FALSE}
library(gtsummary)
```

### 

The *gtsummary* package provides an elegant and flexible way to create publication-ready analytical and summary tables using the R programming language. The *gtsummary* package summarizes data sets, regression models, and more, using sensible defaults with highly customizable capabilities.

### Exercise 16

Pipe `fit_approve` to `tbl_regression()`.

```{r courage-16, exercise = TRUE}

```

```{r courage-16-hint-1, eval = FALSE}
fit_approve |> 
  tbl_...()
```

```{r courage-16-test, include = FALSE}
fit_approve |>
  tbl_regression()
```

<!-- DK: Warn them that there will be an warning message which says: Unable to identify the list of variables. You can ignore this.  -->

### 

Beta for very conservative is 5.6 but it is 0.84 for liberal. This makes sense when taking into consideration what we noticed during the EDA: in 2020, conservatives supported the president more than liberals.  

### Exercise 17

Write a few sentence which summarize your work so far. The first few sentences are the same as what you had at the end of the Justice Section. Add one sentence which describes the modelling approach which you are using, specifying the functional form and the dependent variable. Add one sentence which describes the *direction* (not the magnitude) of the relationship between one of your independent variables and your dependent variable.

```{r courage-17}
question_text(NULL,
	message = "Using the CES, which is one of the largest political surveys in the United States, we seek to understand the relationship between presidential approval and political ideology in 2020. One concern is that survey respondents might be systematically different from other Americans. We are using a cumulative model for ordinal regression.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

One relationship we have noticed is that conservatives tend to support the 2020 president more than liberals. 

### Exercise 18

Update `analysis.qmd`. First, add `library(gtsummary)` to the `setup` code chunk,. Second, add the mathematical formula, in $\LaTeX$ and surrounded by double dollar signs, for your model. Third, add a new code chunk which creates the table of model parameters. `Command/Ctrl + Shift + K` to ensure that everything works.

At the Console, run:

```
tutorial.helpers::show_file("analysis.qmd", start = -8)
```

CP/CR.

```{r courage-18}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

## Temperance
### 

<!-- XX: Choose one. -->

*Temperance is a tree which as for its root very little contentment, and for its fruit calm and peace.* - Buddha
*Temperance is the greatest of all virtues. It subdues every passion and emotion, and almost creates a Heaven upon Earth.* - Joseph Smith Jr.
*Temperance is a bridle of gold; he, who uses it rightly, is more like a god than a man.* - Robert Burton
*Temperance is the firm and moderate dominion of reason over passion and other unrighteous impulses of the mind.* - Marcus Tullius Cicero
*Temperance to be a virtue must be free, and not forced.* - Philip Massinger
*Temperance is simply a disposition of the mind which binds the passion.* - Thomas Aquinas


### Exercise 1

In your own words, describe the use of Temperance in data science.

```{r temperance-1}
question_text(NULL,
	message = "Temperance uses the Data Generating Mechanism to answer the question with which we began. Humility reminds us that this answer is always a lie.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

### Exercise 2

What is the general topic we are investigating? What is the specific question we are trying to answer? 

```{r temperance-2}
question_text(NULL,
	message = "XX: Should be exactly how you started the Wisdom section.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Data science projects almost always begin with a broad topic of interest. Yet, in order to make progress, we need to drill down to a specific question. This leads to the creation of a data generating mechanism, which can now be used to answer lots of questions, thus allowing us to explore the original topic broadly.

### Exercise 3

To answer our question, we need to create a `newdata` object. Which variables (e.g., which columns) do we need to include in this object?

```{r temperance-3}
question_text(NULL,
	message = "XX",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

<!-- XX: Must be all the right hand side variables in fit_approve. And note that the type must (maybe not always . . .) match, like if `treatment` is a factor in the original data used to create fit_approve then it must (?) be a factor in ndata. -->


### Exercise 4

<!-- XX: Sometimes useful to think about this question and the number of posterior questions together, or event to reverse them. -->

Which values do you want the variables in your `newdata` object to have? This is not easy! At the very least, one of the rows should have values which allow you to answer your original question. But, now that you have a model, there are many questions which you might want to answer, the better to get a fuller understanding.

```{r temperance-4}
question_text(NULL,
	message = "XX",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

<!-- XX: Chapter 10 is a great example of this in its full complexity. We want to know how "different" units behave, where the very definition of "different" is that they do not have identical values for all the variables used in fit_approve. -->

<!-- For example, one row in ndata will generally represent the answer to the specific question we started with. But that is just the posterior for one sort of unit. There are lots of different units! Which others might we be interested in? We can generate posteriors for each of them, and then, in some cool graphic, display all those posteriors together. -->

<!-- Note that, previously, this document claimed that the number of rows in ndata corresponded to the number of posteriors you wanted to calculate. But that is not true! -->

### Exercise 5

Here is the R code which creates the `newdata` object: `tibble(whatever) code here`. Type it into the code exercise block and hit "Run Code."

<!-- Asking students to create this object --- even after you help them figure out the columns, rows and values --- is too hard, at least until they get more experiences. Your knowledge drop, for this question and the next, should give them advice on the broad topic of how they can create newdata objects themselves. -->

```{r temperance-5, exercise = TRUE}

```

```{r temperance-5-hint-1, eval = FALSE}

```

```{r temperance-5-test, include = FALSE}

```

### 

### Exercise 6

Behind the scenes, we have created the `ndata` object using this code. To confirm, type `ndata` and hit "Run Code."

<!-- Of course, you need to have added the code to create `ndata` in the setup chunk at the top of the file. -->

```{r temperance-6, exercise = TRUE}

```

```{r temperance-6-hint-1, eval = FALSE}

```

```{r temperance-6-test, include = FALSE}

```

### 

Note that, when you add Temperance-related code to your QMD, you will need to also add code which creates the `ndata` object.

### Exercise 7

Now that we have the `newdata` object, we can create a pipe which uses out fitted model to answer our question. Begin by typing `fit_approve` and clicking "Run Code."

```{r temperance-7, exercise = TRUE}

```

```{r temperance-7-hint-1, eval = FALSE}

```

```{r temperance-7-test, include = FALSE}

```

### 

<!-- XX: Again, the main point of knowledge drops is this area is to explain to students why the newdata object looks the way it does and what it will produce. A great way to teach is via example. That is, explaining that if we had another way with these values, then we would get this posterior. Or, explaining what would be produced if we used add_epred instead of add_predict, and vice verse. -->


### Exercise 8

Pipe `fit_approve` to [XX: either `add_epred_draws()` or `add_predicted_draws()`] with the argument `newdata = ndata`. 



```{r temperance-8, exercise = TRUE}

```

<button onclick = "transfer_code(this)">Copy previous code</button>

```{r temperance-8-hint-1, eval = FALSE}

```

```{r temperance-8-test, include = FALSE}

```

### 

<!-- XX: How do students know whether to use add_epred_draws or add_predicted_draws? This is non-trivial. On some level, we just tell them with the above command. (We don't make them guess.) But we also address this issue explicitly in various knowledg drops, especially this one. -->

<!-- XX: Insert as many questions as necessary to build a nice-looking example of your final plot. In early chapters, this is simple since our questions are simple. They are just one posterior. In later chapters, they become more complex, with the inclusion of several posteriors, as well as manipulation of them to calculate causal effects and whatnot. See the voting postcard example. -->

### Exercise 9

Create a new code chunk in `analysis.qmd`. Label it with `label: plot`. Copy/paste the code which creates your graphic. Don't forget that, at the top of this chunk, you must include code which creates the `ndata` object.

`Command/Ctrl + Shift + K` to ensure that it all works as intended.

At the Console, run:

```
tutorial.helpers::show_file("analysis.qmd", start = -8)
```

CP/CR.

```{r temperance-9}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

### Exercise 10

Write a paragraph which summarizes the project in your own words. The first few sentences are the same as what you had at the end of the Courage section. But, since your question may have evolved, you should feel free to change those sentences. Add at least one sentence which describes at least one quantity of interest (QoI) --- presumably one that answers your question -- and which provides a measure of uncertainty about that QoI.

<!-- XX: Most of the time, there will be some measure of uncertainty associated with your QoI. But not always! The most common counter-example involves a question which asks about the odds or probability of something happening. We would answer such a question by simulating the event with `add_predicted_draws()`. We would then calculate the odds/probability of something happening by seeing how many of the 4,000 draws met the criteria for the event. Assume that was 40%. So, we think that there is a 40% chance that event A will happen. Yet there is no uncertainty associated with that estimate because it, itself, is an expression of uncertainty.  -->

```{r temperance-10}
question_text(NULL,
	message = "XX",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

Edit the summary paragraph in `analysis.qmd` as you see fit, but do not copy/paste our answer exactly. `Command/Ctrl + Shift + K`.


<!-- XX: Again, spend time to make your recommended paragraph perfect. Study the examples in https://ppbds.github.io/primer/cardinal-virtues.html closely. -->

### Exercise 11

Write a few sentences which explain why the estimates for the quantities of interest, and the uncertainty thereof, might be wrong. Suggest an alternative estimate and confidence interval, if you think either might be warranted.

```{r temperance-11}
question_text(NULL,
	message = "XX: This is another example in which the quality of your answer is important. You might or might not suggest an alternate estimate. I always adjust the estimate toward my own subjective sense of a longrun average and/or typical value and/or zero. But that is not necessary. However, you should always increase the confidence interval since the assumptions of your model are always false.",
	answer(NULL, correct = TRUE),
	allow_retry = FALSE,
	incorrect = NULL,
	rows = 6)
```

### 

### Exercise 12

Rearrange the material in `analysis.qmd` so that the order is graphic, paragraph, math and table. Doing so, of course, requires sensible judgment. For example, the code chunk which creates the fitted model must occur before the chunk which creates the graphic. `Command/Ctrl + Shift + K` to ensure that everything works.

At the Console, run:

```
tutorial.helpers::show_file("analysis.qmd")
```

CP/CR.

```{r temperance-12}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Add `rsconnect` to the `.gitignore` file. You don't want your personal Rpubs details stored in the clear on Github. Commit/push everything.

### Exercise 13

Publish `analysis.qmd` to Rpubs. Choose a sensible slug. Copy/paste the url below.

```{r temperance-13}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

## Summary
### 

This tutorial covered [Chapter XX: XX](https://ppbds.github.io/primer/XX.html) of [*Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference*](https://ppbds.github.io/primer/) by [David Kane](https://davidkane.info/). 

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
